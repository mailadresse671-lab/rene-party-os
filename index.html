<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>REN√â OS v9 - CINEMATIC</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --cyan: #00f2ea;
            --pink: #ff0050;
            --purple: #b026ff;
            --green: #39ff14;
            --yellow: #ffee00;
            --dark: #0a0f1f;
            --term-green: #0f0;
            --term-red: #ff3333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body {
            background-color: #000;
            font-family: 'Fredoka', sans-serif;
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* UTILS */
        .hidden { display: none !important; }
        .full-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; overflow: hidden; display: flex; flex-direction: column; }
        .scrollable { overflow-y: auto; -webkit-overflow-scrolling: touch; }

        /* --- CINEMATIC INTRO STYLES --- */
        #view-intro {
            background: #000;
            z-index: 2000;
            font-family: 'Share Tech Mono', monospace; /* Hacker Font */
        }

        /* Scanline Effect (CRT Monitor) */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            pointer-events: none; z-index: 2005; opacity: 0.6;
        }

        /* Background Video */
        #intro-vid-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; opacity: 0.3; filter: hue-rotate(180deg) contrast(1.2);
            z-index: 1;
        }

        /* Terminal Text Area */
        #terminal-console {
            position: absolute; bottom: 100px; left: 20px; right: 20px;
            color: var(--term-green);
            font-size: 1.1rem;
            text-shadow: 0 0 5px var(--term-green);
            z-index: 2;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            min-height: 50%;
        }

        .log-line { margin-bottom: 5px; opacity: 0; animation: typeIn 0.1s forwards; }
        .log-error { color: var(--term-red); text-shadow: 0 0 5px red; font-weight: bold; }
        .log-success { color: var(--cyan); text-shadow: 0 0 5px var(--cyan); }
        .log-sys { color: var(--yellow); font-weight: bold; }

        @keyframes typeIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

        /* Big Overlay Text (Flash Messages) */
        #big-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 100%; text-align: center;
            font-size: 3rem; font-weight: 900;
            color: white; z-index: 5;
            text-shadow: 0 0 20px white;
            opacity: 0;
            pointer-events: none;
        }
        .glitch-anim { animation: glitchSkew 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both infinite; color: var(--term-red); }
        
        @keyframes glitchSkew {
            0% { transform: translate(-51%, -50%) skew(0deg); }
            20% { transform: translate(-50%, -51%) skew(-10deg); }
            40% { transform: translate(-49%, -50%) skew(10deg); }
            60% { transform: translate(-50%, -49%) skew(0deg); }
            80% { transform: translate(-51%, -50%) skew(5deg); }
            100% { transform: translate(-50%, -50%) skew(0deg); }
        }

        /* Flash Screen Red */
        .screen-flash { animation: flashRed 0.2s; }
        @keyframes flashRed { 0% { background: rgba(255,0,0,0.5); } 100% { background: transparent; } }

        #start-btn {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            z-index: 100; padding: 20px 40px; font-family: 'Fredoka'; font-size: 2rem;
            background: var(--pink); color: white; border: none; border-radius: 10px;
            animation: pulse 1.5s infinite; cursor: pointer;
            box-shadow: 0 0 30px var(--pink);
        }
        
        #skip-btn {
            position: absolute; top: 20px; right: 20px; z-index: 100;
            background: rgba(0,0,0,0.5); border: 1px solid white; color: white;
            padding: 8px 15px; border-radius: 20px; cursor: pointer; display: none;
            font-family: 'Fredoka';
        }

        /* --- MAIN APP STYLES (v8) --- */
        #view-login { background: radial-gradient(circle, #1a1a3e 0%, #0a0f1f 100%); z-index: 100; align-items: center; justify-content: center; }
        .login-box { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); border: 3px solid var(--cyan); border-radius: 20px; padding: 40px; text-align: center; width: 90%; max-width: 400px; box-shadow: 0 0 30px rgba(0, 242, 234, 0.3); }
        .login-box h1 { font-size: 3rem; background: linear-gradient(45deg, var(--cyan), var(--pink), var(--purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 5px; }
        .input-field { width: 100%; padding: 15px; margin: 20px 0; background: rgba(0, 0, 0, 0.5); border: 2px solid var(--cyan); border-radius: 10px; color: white; font-size: 1.2rem; text-align: center; outline: none; }
        .btn-main { width: 100%; padding: 15px; background: linear-gradient(135deg, var(--cyan), var(--green)); border: none; border-radius: 10px; color: black; font-weight: 900; font-size: 1.4rem; cursor: pointer; animation: pulse 2s infinite; }

        /* DASHBOARD */
        #view-dash { padding: 20px; align-items: center; }
        .header-title { font-size: 2.5rem; text-align: center; color: var(--pink); margin-top: 20px; }
        .rooms-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; width: 100%; max-width: 600px; padding-bottom: 50px; }
        .room-card { background: rgba(255, 255, 255, 0.05); border: 2px solid var(--cyan); border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 140px; }
        .room-emoji { font-size: 3rem; margin-bottom: 10px; }
        
        /* ROOMS COMMON */
        .room-header { display: flex; align-items: center; justify-content: space-between; padding: 15px; background: rgba(0,0,0,0.8); border-bottom: 2px solid var(--cyan); }
        .back-btn { background: none; border: none; font-size: 1.8rem; cursor: pointer; }
        .room-content { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
        .btn { background: var(--cyan); border: none; border-radius: 8px; padding: 12px 20px; color: black; font-weight: bold; margin: 5px; cursor: pointer; }

        /* SPECIFIC ROOMS */
        .song-display { background: rgba(0,0,0,0.6); border: 2px solid var(--yellow); border-radius: 15px; padding: 20px; width: 100%; text-align: center; margin: 20px 0; }
        .camera-view { width: 100%; aspect-ratio: 1; background: #000; border: 3px solid var(--pink); border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 5rem; margin-bottom: 20px; }
        .filter-btn { font-size: 1.5rem; background: #222; border: 2px solid #555; border-radius: 50%; width: 50px; height: 50px; margin: 5px; }
        .filter-btn.active { background: var(--cyan); }
        .dancefloor-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; max-width: 400px; margin-top: 20px; }
        .pad { aspect-ratio: 1; background: #222; border: 2px solid var(--cyan); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem; }
        .pad:active { background: var(--cyan); color: black; }
        .bottle { font-size: 8rem; margin: 40px 0; transition: transform 3s ease-out; }
        .leaderboard-entry { background: rgba(255,255,255,0.1); width: 100%; padding: 10px; margin: 5px 0; border-radius: 5px; display: flex; justify-content: space-between; border-left: 4px solid var(--yellow); }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <audio id="intro-music" src="intro-sound.mp3" preload="auto"></audio>

    <div id="view-intro" class="full-screen">
        <div class="scanlines"></div>
        <video id="intro-vid-bg" muted playsinline></video>
        
        <div id="terminal-console"></div>
        
        <div id="big-overlay"></div>

        <button id="start-btn" onclick="intro.start()">START THE SHOW üöÄ</button>
        <button id="skip-btn" onclick="intro.skip()">SKIP ‚è©</button>
    </div>

    <div id="view-login" class="full-screen hidden">
        <div class="login-box">
            <h1>üéâ PARTY üéâ</h1>
            <p style="color: var(--green); margin-bottom: 20px;">Die offizielle App f√ºr Ren√©</p>
            <input type="text" id="username" class="input-field" placeholder="Dein Name..." maxlength="12">
            <button class="btn-main" onclick="app.login()">LOS GEHT'S üöÄ</button>
        </div>
    </div>

    <div id="view-dash" class="full-screen hidden scrollable">
        <div class="header-title">PARTY ZENTRALE</div>
        <div class="header-subtitle">Willkommen, <span id="display-name" style="font-weight:bold; color:white;">GAST</span>!</div>
        <div style="display: flex; justify-content: center;">
            <div class="rooms-grid">
                <div class="room-card" onclick="app.nav('karaoke')"><div class="room-emoji">üé§</div><div class="room-name">KARAOKE</div></div>
                <div class="room-card" onclick="app.nav('photobooth')"><div class="room-emoji">üì∏</div><div class="room-name">FOTO BOX</div></div>
                <div class="room-card" onclick="app.nav('trivia')"><div class="room-emoji">üß†</div><div class="room-name">QUIZ</div></div>
                <div class="room-card" onclick="app.nav('bottle')"><div class="room-emoji">üçæ</div><div class="room-name">FLASCHE</div></div>
                <div class="room-card" onclick="app.nav('dancefloor')"><div class="room-emoji">üíÉ</div><div class="room-name">DANCEFLOOR</div></div>
                <div class="room-card" onclick="app.nav('leaderboard')"><div class="room-emoji">üèÜ</div><div class="room-name">RANGLISTE</div></div>
            </div>
        </div>
    </div>

    <div id="view-karaoke" class="full-screen hidden">
        <div class="room-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div class="room-title">KARAOKE</div><div style="width:40px;"></div></div>
        <div class="room-content">
            <div style="font-size: 4rem; animation: pulse 0.5s infinite;">üé§</div>
            <div class="song-display"><h2 id="song-name" style="color:var(--yellow)">Happy Birthday</h2><div id="lyrics" class="lyrics">Happy birthday to you...</div></div>
            <button class="btn" onclick="karaoke.next()">N√ÑCHSTER SONG</button>
        </div>
    </div>
    
    <div id="view-photobooth" class="full-screen hidden">
        <div class="room-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div class="room-title">FOTO BOX</div><div style="width:40px;"></div></div>
        <div class="room-content">
            <div id="camera-display" class="camera-view">üì∏</div>
            <div><button class="filter-btn active" onclick="photobooth.set('üòä')">üòä</button><button class="filter-btn" onclick="photobooth.set('üòé')">üòé</button><button class="filter-btn" onclick="photobooth.set('ü§°')">ü§°</button></div>
            <button class="btn" onclick="photobooth.snap()" style="margin-top:15px;">FOTO MACHEN ‚ú®</button>
            <div id="photo-gallery" style="display:grid; grid-template-columns:repeat(3,1fr); gap:5px; margin-top:20px; width:100%;"></div>
        </div>
    </div>

    <div id="view-trivia" class="full-screen hidden">
        <div class="room-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div class="room-title">QUIZ</div><div style="width:40px;"></div></div>
        <div class="room-content">
            <h2 style="color:var(--yellow)">Punkte: <span id="trivia-score">0</span></h2>
            <div class="question-card"><h3 id="trivia-q" style="margin-bottom:20px;">?</h3><div id="trivia-a"></div></div>
            <button class="btn" onclick="trivia.next()">√úBERSPRINGEN</button>
        </div>
    </div>

    <div id="view-bottle" class="full-screen hidden">
        <div class="room-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div class="room-title">FLASCHE</div><div style="width:40px;"></div></div>
        <div class="room-content"><div id="bottle" class="bottle">üçæ</div><div id="bottle-res" style="font-size:1.5rem; color:var(--yellow); text-align:center;">Dreh sie!</div><button class="btn" onclick="bottle.spin()" style="margin-top:20px;">DREHEN üåÄ</button></div>
    </div>

    <div id="view-dancefloor" class="full-screen hidden">
        <div class="room-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div class="room-title">DANCEFLOOR</div><div style="width:40px;"></div></div>
        <div class="room-content">
            <h3 style="color:var(--cyan)">Make some Noise!</h3>
            <div class="dancefloor-grid">
                <div class="pad" onmousedown="dance.hit('kick')" ontouchstart="dance.hit('kick')">ü•Å</div>
                <div class="pad" onmousedown="dance.hit('snare')" ontouchstart="dance.hit('snare')">üëè</div>
                <div class="pad" onmousedown="dance.hit('hat')" ontouchstart="dance.hit('hat')">üêç</div>
                <div class="pad" onmousedown="dance.hit('bass1')" ontouchstart="dance.hit('bass1')">üé∏</div>
                <div class="pad" onmousedown="dance.hit('bass2')" ontouchstart="dance.hit('bass2')">üéª</div>
                <div class="pad" onmousedown="dance.hit('laser')" ontouchstart="dance.hit('laser')">üî´</div>
            </div>
        </div>
    </div>

    <div id="view-leaderboard" class="full-screen hidden">
        <div class="room-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div class="room-title">RANGLISTE</div><div style="width:40px;"></div></div>
        <div class="room-content"><div id="lb-list" style="width:100%;"></div></div>
    </div>

    <script>
        // --- AUDIO ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const ctx = new AudioContext();
        
        // --- INTRO LOGIC ---
        const intro = {
            videos: ['glitch1.mp4', 'glitch2.mp4', 'glitch3.mp4'],
            running: false,
            
            start: () => {
                document.getElementById('start-btn').style.display = 'none';
                document.getElementById('skip-btn').style.display = 'block';
                intro.running = true;
                
                // Music
                const audio = document.getElementById('intro-music');
                audio.volume = 1.0;
                audio.play().catch(e => console.log("Audio blockiert"));
                if(ctx.state === 'suspended') ctx.resume();

                // Video Loop
                const vid = document.getElementById('intro-vid-bg');
                let vIdx = 0;
                const playVid = () => {
                    if(!intro.running) return;
                    vid.src = intro.videos[vIdx];
                    vid.play();
                    vIdx = (vIdx + 1) % intro.videos.length;
                };
                vid.onended = playVid;
                playVid();

                // Start Sequence
                intro.sequence();
            },

            log: (txt, type = 'normal') => {
                if(!intro.running) return;
                const c = document.getElementById('terminal-console');
                const d = document.createElement('div');
                d.className = 'log-line ' + (type === 'error' ? 'log-error' : type === 'success' ? 'log-success' : type === 'sys' ? 'log-sys' : '');
                d.innerText = "> " + txt;
                c.appendChild(d);
                c.scrollTop = c.scrollHeight;
            },

            bigText: (txt, glitch = false) => {
                if(!intro.running) return;
                const el = document.getElementById('big-overlay');
                el.innerText = txt;
                el.style.opacity = 1;
                el.className = glitch ? 'glitch-anim' : '';
                if(glitch) document.getElementById('view-intro').classList.add('screen-flash');
                setTimeout(() => {
                    el.style.opacity = 0;
                    document.getElementById('view-intro').classList.remove('screen-flash');
                }, 1500);
            },

            sequence: async () => {
                const sleep = ms => new Promise(r => setTimeout(r, ms));
                
                intro.log("BOOT SEQUENCE INITIATED..."); await sleep(1000);
                intro.log("Loading Kernel v9.0...", "sys"); await sleep(800);
                intro.log("Checking User Identity..."); await sleep(1200);
                intro.log("Identity Confirmed: DoN", "success"); await sleep(500);
                intro.log("Connecting to Server: 192.168.178.1..."); await sleep(1500);
                intro.log("Connection Established.", "success"); await sleep(500);
                
                intro.bigText("VERBINDUNG OK"); await sleep(2000);

                intro.log("Lade Party-Module..."); await sleep(500);
                intro.log("Module: Musik [OK]"); await sleep(200);
                intro.log("Module: Drinks [OK]"); await sleep(200);
                intro.log("Module: Stimmung [LADE...]"); await sleep(1000);
                
                intro.log("WARNUNG: Datumskonflikt erkannt!", "error"); await sleep(1000);
                intro.log("Ziel: 01.12. | Aktuell: 24.12.", "error"); await sleep(1000);
                intro.bigText("ZUGRIFF VERWEIGERT", true); await sleep(2000);
                
                intro.log("Starte Override-Protokoll...", "sys"); await sleep(1000);
                intro.log("Bypassing Firewall..."); await sleep(1500);
                intro.log("Brute-Force Attacke l√§uft..."); await sleep(2000);
                
                intro.bigText("HACKING...", true); await sleep(2500);
                
                intro.log("Passwort gefunden: FAMILY_FIRST", "success"); await sleep(1000);
                intro.log("Zugriff gew√§hrt.", "success"); await sleep(1000);
                intro.log("Lade Geschenk...", "sys"); await sleep(2000);
                intro.log("Lade Erinnerungen...", "sys"); await sleep(2000);
                
                intro.log("SYSTEM BEREIT.", "success"); await sleep(1000);
                intro.bigText("SYSTEM √úBERNOMMEN", true); await sleep(3000);
                
                intro.log("Happy Birthday, Ren√©.", "sys"); await sleep(1000);
                intro.bigText("HAPPY BIRTHDAY REN√â"); await sleep(3000);
                
                intro.log("Viel Spa√ü mit deiner App.", "success"); await sleep(2000);
                intro.skip();
            },

            skip: () => {
                intro.running = false;
                const audio = document.getElementById('intro-music');
                audio.pause(); audio.currentTime = 0;
                document.getElementById('view-intro').classList.add('hidden');
                document.getElementById('view-login').classList.remove('hidden');
            }
        };

        // --- APP LOGIC ---
        const app = {
            user: localStorage.getItem('user') || '',
            scores: JSON.parse(localStorage.getItem('scores')) || [],
            login: () => {
                const n = document.getElementById('username').value.trim();
                if(!n) return alert('Name fehlt!');
                app.user = n; localStorage.setItem('user', n);
                document.getElementById('display-name').innerText = n;
                app.nav('dash');
                if(ctx.state === 'suspended') ctx.resume();
            },
            nav: (v) => {
                document.querySelectorAll('.full-screen').forEach(e => e.classList.add('hidden'));
                document.getElementById('view-'+v).classList.remove('hidden');
                if(v==='leaderboard') app.updateLB();
            },
            addScore: (p) => {
                let s = app.scores.find(x => x.u === app.user);
                if(s) s.p += p; else app.scores.push({u:app.user, p:p});
                localStorage.setItem('scores', JSON.stringify(app.scores));
            },
            updateLB: () => {
                const l = app.scores.sort((a,b)=>b.p-a.p);
                document.getElementById('lb-list').innerHTML = l.map((x,i)=>`<div class="leaderboard-entry"><span>#${i+1}</span><span>${x.u}</span><span>${x.p}</span></div>`).join('') || 'Leer';
            }
        };

        // --- MODULES ---
        const karaoke = {
            s: [{n:'Happy Birthday',l:'Happy birthday to you...'},{n:'Atemlos',l:'Atemlos durch die Nacht...'}], i:0,
            next: () => { karaoke.i=(karaoke.i+1)%karaoke.s.length; document.getElementById('song-name').innerText=karaoke.s[karaoke.i].n; document.getElementById('lyrics').innerText=karaoke.s[karaoke.i].l; }
        };
        const photobooth = {
            f: 'üòä', set: (v)=>{ photobooth.f=v; document.getElementById('camera-display').innerText=v; document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active')); event.target.classList.add('active'); },
            snap: ()=>{ 
                const d=document.createElement('div'); d.style.cssText='aspect-ratio:1;background:#222;border:1px solid #00f2ea;display:flex;align-items:center;justify-content:center;font-size:1.5rem;'; d.innerText=photobooth.f;
                document.getElementById('photo-gallery').prepend(d); app.addScore(10); alert('+10 Pkt');
            }
        };
        const trivia = {
            q: [{q:'Alter von Ren√©?',a:['20','25','29','Egal'],c:2},{q:'Bester Cousin?',a:['DoN','DoN','DoN','DoN'],c:0}], i:0,
            next: () => {
                trivia.i=(trivia.i+1)%trivia.q.length; 
                const q=trivia.q[trivia.i]; document.getElementById('trivia-q').innerText=q.q; 
                document.getElementById('trivia-a').innerHTML=q.a.map((x,j)=>`<button class="answer-btn" onclick="trivia.check(${j},${q.c},this)">${x}</button>`).join('');
            },
            check: (j,c,btn) => { if(j===c){btn.classList.add('correct'); app.addScore(50); setTimeout(trivia.next,1000);}else{btn.classList.add('wrong');} }
        }; trivia.next();
        const bottle = {
            spin: () => {
                const el=document.getElementById('bottle'); el.style.transform=`rotate(${720+Math.random()*720}deg)`;
                document.getElementById('bottle-res').innerText="..."; setTimeout(()=>{document.getElementById('bottle-res').innerText=["Trink!","Tanze!","Sing!"].sort(()=>0.5-Math.random())[0]; app.addScore(20);},3000);
            }
        };
        const dance = {
            hit: (t) => {
                if(ctx.state==='suspended')ctx.resume();
                const o=ctx.createOscillator(),g=ctx.createGain(); o.connect(g); g.connect(ctx.destination);
                const n=ctx.currentTime;
                if(t==='kick'){o.frequency.setValueAtTime(150,n);o.frequency.exponentialRampToValueAtTime(0.01,n+0.5);g.gain.setValueAtTime(1,n);g.gain.exponentialRampToValueAtTime(0.01,n+0.5);}
                else if(t.includes('bass')){o.type='sawtooth';o.frequency.value=t==='bass1'?65:110;g.gain.setValueAtTime(0.3,n);g.gain.linearRampToValueAtTime(0,n+0.5);}
                else{o.type='square';o.frequency.setValueAtTime(800,n);g.gain.setValueAtTime(0.1,n);g.gain.exponentialRampToValueAtTime(0.01,n+0.1);}
                o.start(n); o.stop(n+0.5); app.addScore(5);
            }
        };
        if(app.user) document.getElementById('display-name').innerText=app.user;
    </script>
</body>
</html>
