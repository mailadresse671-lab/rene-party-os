<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>REN√â PARTY v8 - ULTIMATE</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --cyan: #00f2ea;
            --pink: #ff0050;
            --purple: #b026ff;
            --green: #39ff14;
            --yellow: #ffee00;
            --dark: #0a0f1f;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body {
            background: linear-gradient(135deg, #050810 0%, var(--dark) 100%);
            font-family: 'Fredoka', sans-serif;
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* UTILS */
        .hidden { display: none !important; }
        .full-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; overflow: hidden; display: flex; flex-direction: column; }
        .scrollable { overflow-y: auto; -webkit-overflow-scrolling: touch; }

        /* ANIMATIONS */
        @keyframes micBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* LOGIN STYLE */
        #view-login {
            align-items: center;
            justify-content: center;
            z-index: 100;
            background: radial-gradient(circle, #1a1a3e 0%, #0a0f1f 100%);
        }

        .login-box {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 3px solid var(--cyan);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 30px rgba(0, 242, 234, 0.3);
        }

        .login-box h1 {
            font-size: 3rem;
            background: linear-gradient(45deg, var(--cyan), var(--pink), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
            letter-spacing: 2px;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--cyan);
            border-radius: 10px;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            outline: none;
        }

        .btn-main {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--cyan), var(--green));
            border: none;
            border-radius: 10px;
            color: black;
            font-weight: 900;
            font-size: 1.4rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 242, 234, 0.3);
            animation: pulse 2s infinite;
        }

        /* DASHBOARD STYLE */
        #view-dash {
            align-items: center;
            padding: 20px;
        }

        .header-title {
            font-size: 2.5rem;
            text-align: center;
            color: var(--pink);
            text-shadow: 0 0 10px var(--pink);
            margin-top: 20px;
        }

        .header-subtitle {
            font-size: 1.2rem;
            color: var(--green);
            text-align: center;
            margin-bottom: 30px;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            width: 100%;
            max-width: 600px;
            padding-bottom: 50px;
        }

        .room-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--cyan);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 140px;
        }

        .room-card:active { transform: scale(0.95); background: rgba(0, 242, 234, 0.1); }
        .room-emoji { font-size: 3rem; margin-bottom: 10px; }
        .room-name { font-weight: bold; color: var(--cyan); font-size: 1rem; }
        .room-desc { font-size: 0.8rem; color: #aaa; }

        /* COMMON ROOM STYLES */
        .room-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: rgba(0,0,0,0.8);
            border-bottom: 2px solid var(--cyan);
        }
        .back-btn { background: none; border: none; font-size: 1.8rem; cursor: pointer; }
        .room-title { font-size: 1.5rem; font-weight: bold; color: white; }
        .room-content { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
        
        .btn {
            background: var(--cyan);
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            color: black;
            font-weight: bold;
            font-size: 1rem;
            margin: 5px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .btn:active { transform: scale(0.95); }

        /* KARAOKE */
        .song-display {
            background: rgba(0,0,0,0.6);
            border: 2px solid var(--yellow);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            margin: 20px 0;
        }
        .lyrics { white-space: pre-wrap; line-height: 1.6; font-size: 1.1rem; margin-top: 15px; }

        /* PHOTOBOOTH */
        .camera-view {
            width: 100%; max-width: 350px; aspect-ratio: 1;
            background: #000; border: 3px solid var(--pink);
            border-radius: 15px; display: flex; align-items: center; justify-content: center;
            font-size: 5rem; margin-bottom: 20px;
        }
        .filter-btn { font-size: 1.5rem; background: #222; border: 2px solid #555; border-radius: 50%; width: 50px; height: 50px; margin: 5px; cursor: pointer; }
        .filter-btn.active { border-color: var(--cyan); background: var(--cyan); }

        /* TRIVIA */
        .question-card {
            background: rgba(255,255,255,0.05); border: 1px solid var(--cyan);
            padding: 20px; border-radius: 10px; width: 100%; max-width: 500px;
            text-align: center; margin-bottom: 20px;
        }
        .answer-btn {
            width: 100%; padding: 15px; margin: 5px 0;
            background: rgba(0,0,0,0.5); border: 2px solid var(--pink);
            color: white; border-radius: 8px; font-size: 1rem; cursor: pointer;
        }
        .answer-btn.correct { background: var(--green); color: black; border-color: var(--green); }
        .answer-btn.wrong { background: red; border-color: red; }

        /* BOTTLE */
        .bottle { font-size: 8rem; margin: 40px 0; transition: transform 3s ease-out; }
        .spinner-text { font-size: 1.5rem; color: var(--yellow); text-align: center; min-height: 80px; }

        /* DANCEFLOOR */
        .dancefloor-grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
            width: 100%; max-width: 400px; margin-top: 20px;
        }
        .pad {
            aspect-ratio: 1; background: #222; border: 2px solid var(--cyan);
            border-radius: 10px; display: flex; align-items: center; justify-content: center;
            font-size: 2rem; cursor: pointer;
        }
        .pad:active { background: var(--cyan); color: black; box-shadow: 0 0 20px var(--cyan); }

        /* LEADERBOARD */
        .leaderboard-entry {
            background: rgba(255,255,255,0.1); width: 100%; max-width: 500px;
            padding: 10px; margin: 5px 0; border-radius: 5px;
            display: flex; justify-content: space-between; border-left: 4px solid var(--yellow);
        }
    </style>
</head>
<body>

    <div id="view-login" class="full-screen">
        <div class="login-box">
            <h1>üéâ PARTY üéâ</h1>
            <p style="color: var(--green); margin-bottom: 20px;">Die offizielle App f√ºr Ren√©</p>
            <input type="text" id="username" class="input-field" placeholder="Dein Name..." maxlength="12">
            <button class="btn-main" onclick="app.login()">LOS GEHT'S üöÄ</button>
        </div>
    </div>

    <div id="view-dash" class="full-screen hidden scrollable">
        <div class="header-title">PARTY ZENTRALE</div>
        <div class="header-subtitle">Willkommen, <span id="display-name" style="font-weight:bold; color:white;">GAST</span>!</div>
        
        <div style="display: flex; justify-content: center;">
            <div class="rooms-grid">
                <div class="room-card" onclick="app.enterRoom('karaoke')">
                    <div class="room-emoji">üé§</div>
                    <div class="room-name">KARAOKE</div>
                    <div class="room-desc">Sing f√ºr Ren√©</div>
                </div>
                <div class="room-card" onclick="app.enterRoom('photobooth')">
                    <div class="room-emoji">üì∏</div>
                    <div class="room-name">FOTO BOX</div>
                    <div class="room-desc">Lustige Selfies</div>
                </div>
                <div class="room-card" onclick="app.enterRoom('trivia')">
                    <div class="room-emoji">üß†</div>
                    <div class="room-name">QUIZ</div>
                    <div class="room-desc">Kennst du Ren√©?</div>
                </div>
                <div class="room-card" onclick="app.enterRoom('bottle')">
                    <div class="room-emoji">üçæ</div>
                    <div class="room-name">FLASCHE</div>
                    <div class="room-desc">Wahrheit/Pflicht</div>
                </div>
                <div class="room-card" onclick="app.enterRoom('dancefloor')">
                    <div class="room-emoji">üíÉ</div>
                    <div class="room-name">DANCEFLOOR</div>
                    <div class="room-desc">Bau den Beat</div>
                </div>
                <div class="room-card" onclick="app.enterRoom('leaderboard')">
                    <div class="room-emoji">üèÜ</div>
                    <div class="room-name">RANGLISTE</div>
                    <div class="room-desc">Wer ist King?</div>
                </div>
            </div>
        </div>
    </div>

    <div id="view-karaoke" class="full-screen hidden">
        <div class="room-header">
            <button class="back-btn" onclick="app.backToDash()">‚¨ÖÔ∏è</button>
            <div class="room-title">KARAOKE</div>
            <div style="width:40px;"></div>
        </div>
        <div class="room-content">
            <div style="font-size: 4rem; animation: micBounce 1s infinite alternate;">üé§</div>
            <div class="song-display">
                <h2 id="song-name" style="color:var(--yellow); margin-bottom:10px;">Happy Birthday</h2>
                <div id="lyrics" class="lyrics">Happy birthday to you...</div>
            </div>
            <button class="btn" onclick="karaoke.nextSong()">‚è≠Ô∏è N√ÑCHSTER SONG</button>
        </div>
    </div>

    <div id="view-photobooth" class="full-screen hidden">
        <div class="room-header">
            <button class="back-btn" onclick="app.backToDash()">‚¨ÖÔ∏è</button>
            <div class="room-title">FOTO BOX</div>
            <div style="width:40px;"></div>
        </div>
        <div class="room-content">
            <div id="camera-display" class="camera-view">üì∏</div>
            <div style="margin-bottom:20px;">
                <button class="filter-btn active" onclick="photobooth.setFilter('üòä')">üòä</button>
                <button class="filter-btn" onclick="photobooth.setFilter('üòé')">üòé</button>
                <button class="filter-btn" onclick="photobooth.setFilter('ü§°')">ü§°</button>
                <button class="filter-btn" onclick="photobooth.setFilter('üëΩ')">üëΩ</button>
            </div>
            <button class="btn" onclick="photobooth.takePic()" style="width:200px; font-size:1.2rem;">FOTO MACHEN ‚ú®</button>
            <div id="photo-gallery" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-top: 20px; width:100%; max-width:400px;"></div>
        </div>
    </div>

    <div id="view-trivia" class="full-screen hidden">
        <div class="room-header">
            <button class="back-btn" onclick="app.backToDash()">‚¨ÖÔ∏è</button>
            <div class="room-title">QUIZ</div>
            <div style="width:40px;"></div>
        </div>
        <div class="room-content">
            <h2 style="color:var(--yellow)">Punkte: <span id="trivia-score">0</span></h2>
            <div class="question-card">
                <h3 id="trivia-question" style="margin-bottom:20px;">Frage l√§dt...</h3>
                <div id="trivia-answers"></div>
            </div>
            <button class="btn" onclick="trivia.nextQuestion()">√úBERSPRINGEN ‚è©</button>
        </div>
    </div>

    <div id="view-bottle" class="full-screen hidden">
        <div class="room-header">
            <button class="back-btn" onclick="app.backToDash()">‚¨ÖÔ∏è</button>
            <div class="room-title">FLASCHENDREHEN</div>
            <div style="width:40px;"></div>
        </div>
        <div class="room-content">
            <div id="bottle" class="bottle">üçæ</div>
            <div id="spinner-text" class="spinner-text">Dr√ºck den Button!</div>
            <button class="btn" onclick="bottle.spin()" style="padding: 20px 40px; font-size: 1.5rem; margin-top:20px;">DREHEN üåÄ</button>
        </div>
    </div>

    <div id="view-dancefloor" class="full-screen hidden">
        <div class="room-header">
            <button class="back-btn" onclick="app.backToDash()">‚¨ÖÔ∏è</button>
            <div class="room-title">DANCEFLOOR</div>
            <div style="width:40px;"></div>
        </div>
        <div class="room-content">
            <h3 style="color:var(--cyan); margin-bottom:10px;">PRODUCER MODE</h3>
            <div class="dancefloor-grid">
                <div class="pad" onmousedown="dancefloor.hit('kick')" ontouchstart="dancefloor.hit('kick')">ü•Å</div>
                <div class="pad" onmousedown="dancefloor.hit('snare')" ontouchstart="dancefloor.hit('snare')">üëè</div>
                <div class="pad" onmousedown="dancefloor.hit('hat')" ontouchstart="dancefloor.hit('hat')">üêç</div>
                <div class="pad" onmousedown="dancefloor.hit('bass1')" ontouchstart="dancefloor.hit('bass1')">üé∏</div>
                <div class="pad" onmousedown="dancefloor.hit('bass2')" ontouchstart="dancefloor.hit('bass2')">üéª</div>
                <div class="pad" onmousedown="dancefloor.hit('laser')" ontouchstart="dancefloor.hit('laser')">üî´</div>
            </div>
            <p style="margin-top:20px; color:#aaa;">Tippe auf die Pads!</p>
        </div>
    </div>

    <div id="view-leaderboard" class="full-screen hidden">
        <div class="room-header">
            <button class="back-btn" onclick="app.backToDash()">‚¨ÖÔ∏è</button>
            <div class="room-title">RANGLISTE</div>
            <div style="width:40px;"></div>
        </div>
        <div class="room-content">
            <div id="leaderboard-list" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
        </div>
    </div>

    <script>
        // --- AUDIO ENGINE ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const ctx = new AudioContext();
        
        // --- APP LOGIC ---
        const app = {
            user: localStorage.getItem('user') || '',
            scores: JSON.parse(localStorage.getItem('scores')) || [],

            login: () => {
                const name = document.getElementById('username').value.trim();
                if (!name) return alert('Bitte gib einen Namen ein!');
                app.user = name;
                localStorage.setItem('user', name);
                document.getElementById('display-name').innerText = name;
                
                // Audio Context starten (User Interaction required)
                if (ctx.state === 'suspended') ctx.resume();
                
                app.nav('dash');
            },

            nav: (view) => {
                document.querySelectorAll('.full-screen').forEach(el => el.classList.add('hidden'));
                document.getElementById('view-' + view).classList.remove('hidden');
                if(view === 'dash') app.updateLeaderboard();
            },

            enterRoom: (room) => app.nav(room),
            backToDash: () => app.nav('dash'),

            addScore: (points) => {
                // Check if user already has score, update it
                const existing = app.scores.find(s => s.user === app.user);
                if(existing) {
                    existing.points += points;
                } else {
                    app.scores.push({ user: app.user, points: points });
                }
                localStorage.setItem('scores', JSON.stringify(app.scores));
            },

            updateLeaderboard: () => {
                const sorted = [...app.scores].sort((a, b) => b.points - a.points);
                let html = '';
                sorted.forEach((s, i) => {
                    html += `<div class="leaderboard-entry">
                        <span style="font-weight:bold; color:var(--yellow)">#${i+1}</span>
                        <span style="color:white">${s.user}</span>
                        <span style="color:var(--green)">${s.points} Pkt</span>
                    </div>`;
                });
                document.getElementById('leaderboard-list').innerHTML = html || '<p style="color:#aaa">Noch keine Punkte!</p>';
            }
        };

        // --- KARAOKE ---
        const karaoke = {
            songs: [
                { name: 'Happy Birthday', lyrics: 'Happy birthday to you\nHappy birthday to you\nHappy birthday lieber Ren√©\nHappy birthday to you! üéµ' },
                { name: 'Atemlos', lyrics: 'Atemlos durch die Nacht\nBis ein neuer Tag erwacht\nAtemlos einfach raus\nDeine Augen ziehen mich aus! üíÉ' },
                { name: 'Griechischer Wein', lyrics: 'Griechischer Wein\nIst so wie das Blut der Erde\nKomm schenk dir ein\nUnd wenn ich dann traurig werde... üç∑' }
            ],
            idx: 0,
            nextSong: () => {
                karaoke.idx = (karaoke.idx + 1) % karaoke.songs.length;
                document.getElementById('song-name').innerText = karaoke.songs[karaoke.idx].name;
                document.getElementById('lyrics').innerText = karaoke.songs[karaoke.idx].lyrics;
            }
        };

        // --- PHOTOBOOTH ---
        const photobooth = {
            filter: 'üòä',
            setFilter: (f) => {
                photobooth.filter = f;
                document.getElementById('camera-display').innerText = f;
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                event.target.classList.add('active');
            },
            takePic: () => {
                const gallery = document.getElementById('photo-gallery');
                const div = document.createElement('div');
                div.style.cssText = 'aspect-ratio:1; background:#222; border:1px solid var(--cyan); display:flex; align-items:center; justify-content:center; font-size:1.5rem;';
                div.innerText = photobooth.filter;
                gallery.prepend(div);
                app.addScore(10);
                alert("Foto gespeichert! +10 Punkte");
            }
        };

        // --- TRIVIA ---
        const trivia = {
            questions: [
                { q: "Wie alt wird Ren√© gef√ºhlt?", a: ["18", "25", "29", "100"], c: 2 },
                { q: "Was ist Ren√©s Lieblingsgetr√§nk?", a: ["Wasser", "Bier", "Red Bull", "Kaffee"], c: 2 },
                { q: "Wo findet die Party statt?", a: ["Hier", "Mond", "Mars", "Berlin"], c: 0 },
                { q: "Wer ist der beste DJ?", a: ["DoN", "Guetta", "Avicii", "Tiesto"], c: 0 }
            ],
            idx: 0,
            score: 0,
            show: () => {
                const q = trivia.questions[trivia.idx];
                document.getElementById('trivia-question').innerText = q.q;
                const div = document.getElementById('trivia-answers');
                div.innerHTML = '';
                q.a.forEach((ans, i) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.innerText = ans;
                    btn.onclick = () => trivia.check(i, q.c, btn);
                    div.appendChild(btn);
                });
            },
            check: (i, c, btn) => {
                if(i === c) {
                    btn.classList.add('correct');
                    trivia.score += 50;
                    document.getElementById('trivia-score').innerText = trivia.score;
                    app.addScore(50);
                    setTimeout(trivia.nextQuestion, 1000);
                } else {
                    btn.classList.add('wrong');
                }
            },
            nextQuestion: () => {
                trivia.idx = (trivia.idx + 1) % trivia.questions.length;
                trivia.show();
            }
        };
        trivia.show();

        // --- BOTTLE ---
        const bottle = {
            spinning: false,
            tasks: ["Trink einen Shot!", "Mach 10 Liegest√ºtze!", "Umarm den Nachbarn!", "Erz√§hl einen Witz!", "Mach ein peinliches Selfie!"],
            spin: () => {
                if(bottle.spinning) return;
                bottle.spinning = true;
                const el = document.getElementById('bottle');
                const rand = 720 + Math.random() * 720;
                el.style.transform = `rotate(${rand}deg)`;
                document.getElementById('spinner-text').innerText = "Dreht sich...";
                
                setTimeout(() => {
                    bottle.spinning = false;
                    const task = bottle.tasks[Math.floor(Math.random() * bottle.tasks.length)];
                    document.getElementById('spinner-text').innerText = task;
                    app.addScore(20);
                }, 3000);
            }
        };

        // --- DANCEFLOOR (SYNTH) ---
        const dancefloor = {
            hit: (type) => {
                if(event) event.preventDefault(); // Stop double fire on touch
                const osc = ctx.createOscillator();
                const g = ctx.createGain();
                osc.connect(g);
                g.connect(ctx.destination);
                
                const now = ctx.currentTime;
                
                if(type === 'kick') {
                    osc.frequency.setValueAtTime(150, now);
                    osc.frequency.exponentialRampToValueAtTime(0.01, now + 0.5);
                    g.gain.setValueAtTime(1, now);
                    g.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                    osc.start(now);
                    osc.stop(now + 0.5);
                } else if(type === 'snare') {
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(100, now);
                    g.gain.setValueAtTime(0.5, now);
                    g.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
                    osc.start(now);
                    osc.stop(now + 0.2);
                } else if(type.startsWith('bass')) {
                    osc.type = 'sawtooth';
                    osc.frequency.value = type === 'bass1' ? 65 : 110;
                    g.gain.setValueAtTime(0.3, now);
                    g.gain.linearRampToValueAtTime(0, now + 0.5);
                    osc.start(now);
                    osc.stop(now + 0.5);
                } else {
                    // Laser/Hat
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(type==='laser'?800:8000, now);
                    osc.frequency.exponentialRampToValueAtTime(100, now + 0.2);
                    g.gain.setValueAtTime(0.1, now);
                    g.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                    osc.start(now);
                    osc.stop(now + 0.2);
                }
                app.addScore(5);
            }
        };

        // Init user display
        if(app.user) document.getElementById('display-name').innerText = app.user;

    </script>
</body>
</html>
