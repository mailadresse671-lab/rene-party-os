<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>REN√â OS v10 - FINAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
    <style>
        :root {
            --cyan: #00f2ea; --pink: #ff0050; --purple: #b026ff; --green: #39ff14;
            --yellow: #ffee00; --dark: #020617; --term-green: #0f0; --term-red: #f00;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { background-color: #000; font-family: 'Fredoka', sans-serif; color: white; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        .hidden { display: none !important; }
        .full-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; overflow: hidden; display: flex; flex-direction: column; }
        .scrollable { overflow-y: auto; -webkit-overflow-scrolling: touch; }

        /* INTRO */
        #view-intro { background: #000; z-index: 2000; font-family: 'Share Tech Mono', monospace; }
        #intro-vid-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.3; filter: hue-rotate(180deg); z-index: 1; }
        #terminal-console { position: absolute; bottom: 80px; left: 20px; right: 20px; color: var(--term-green); font-size: 1rem; z-index: 2; height: 50%; display: flex; flex-direction: column; justify-content: flex-end; }
        .log-line { margin-bottom: 4px; opacity: 0; animation: fadeIn 0.1s forwards; }
        #big-overlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; text-align: center; font-size: 3rem; font-weight: 900; z-index: 5; opacity: 0; transition: 0.3s; }
        #start-btn { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 100; padding: 20px 40px; font-size: 1.8rem; background: var(--pink); border: none; border-radius: 10px; color: white; cursor: pointer; box-shadow: 0 0 20px var(--pink); }

        /* LOGIN & DASH */
        #view-login { background: radial-gradient(circle, #1a1a3e 0%, #0a0f1f 100%); z-index: 100; align-items: center; justify-content: center; }
        .login-box { background: rgba(15, 23, 42, 0.9); border: 2px solid var(--cyan); border-radius: 20px; padding: 30px; text-align: center; width: 85%; max-width: 350px; }
        .input-field { width: 100%; padding: 12px; margin: 15px 0; background: #000; border: 1px solid var(--cyan); color: white; border-radius: 8px; text-align: center; }
        .rooms-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; width: 100%; }
        .room-card { background: rgba(255,255,255,0.05); border: 1px solid var(--cyan); border-radius: 15px; padding: 15px; text-align: center; min-height: 120px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .room-emoji { font-size: 2.5rem; }

        /* HEADER & UI */
        .app-header { height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; background: #111; border-bottom: 1px solid var(--cyan); }
        .back-btn { background: none; border: none; color: white; font-size: 1.5rem; }
        .room-content { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        .btn { background: var(--cyan); border: none; border-radius: 8px; padding: 12px 20px; font-weight: bold; margin-top: 10px; color: #000; }

        /* GAMES & TOOLS */
        #snake-canvas { background: #111; border: 2px solid var(--cyan); width: 280px; height: 280px; }
        .chat-area { flex: 1; width: 100%; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; padding-bottom: 60px; }
        .msg { padding: 8px 12px; border-radius: 10px; max-width: 80%; font-size: 0.9rem; }
        .mine { align-self: flex-end; background: var(--cyan); color: #000; }
        .others { align-self: flex-start; background: #333; }
        .input-bar { position: fixed; bottom: 0; width: 100%; background: #111; padding: 10px; display: flex; gap: 5px; }
        .dj-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 100%; }
        .pad { aspect-ratio: 1; background: #222; border: 1px solid var(--cyan); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <audio id="intro-music" src="intro-sound.mp3"></audio>

    <div id="view-intro" class="full-screen">
        <video id="intro-vid-bg" muted playsinline></video>
        <div id="terminal-console"></div>
        <div id="big-overlay"></div>
        <button id="start-btn" onclick="intro.start()">START SHOW üöÄ</button>
    </div>

    <div id="view-login" class="full-screen hidden">
        <div class="login-box">
            <h1 style="color:var(--cyan)">PARTY TIME</h1>
            <p>F√ºr Ren√© OS v10</p>
            <input type="text" id="username" class="input-field" placeholder="Dein Name..." maxlength="10">
            <button class="btn" style="width:100%" onclick="app.login()">LOS GEHT'S</button>
        </div>
    </div>

    <div id="view-dash" class="full-screen hidden scrollable">
        <h2 style="text-align:center; margin-top:20px; color:var(--pink)">PROFIL: <span id="display-name">...</span></h2>
        <div class="rooms-grid">
            <div class="room-card" onclick="app.nav('chat')"><div class="room-emoji">üí¨</div><div>Chat</div></div>
            <div class="room-card" onclick="app.nav('snake')"><div class="room-emoji">üêç</div><div>Snake</div></div>
            <div class="room-card" onclick="app.nav('dj')"><div class="room-emoji">üéπ</div><div>Beats</div></div>
            <div class="room-card" onclick="app.nav('tod')"><div class="room-emoji">üé≤</div><div>Party</div></div>
            <div class="room-card" onclick="app.nav('art')"><div class="room-emoji">üé®</div><div>Picasso</div></div>
        </div>
    </div>

    <div id="view-chat" class="full-screen hidden">
        <div class="app-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div>CHAT</div><div style="width:30px"></div></div>
        <div id="chat-list" class="chat-area"></div>
        <div class="input-bar"><input type="text" id="chat-in" class="input-field" style="margin:0; flex:1" placeholder="Text..."><button onclick="app.chatSend()" class="btn" style="margin:0">‚û§</button></div>
    </div>

    <div id="view-snake" class="full-screen hidden">
        <div class="app-header"><button class="back-btn" onclick="app.nav('dash');snake.stop()">‚¨ÖÔ∏è</button><div>SNAKE</div><div style="width:30px"></div></div>
        <div class="room-content"><canvas id="snake-canvas" width="280" height="280"></canvas><button class="btn" onclick="snake.start()">START</button></div>
    </div>

    <div id="view-dj" class="full-screen hidden">
        <div class="app-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div>BEATS</div><div style="width:30px"></div></div>
        <div class="room-content"><div class="dj-grid">
            <div class="pad" onclick="dj.hit(150)">ü•Å</div><div class="pad" onclick="dj.hit(300)">üëè</div><div class="pad" onclick="dj.hit(800)">üêç</div>
            <div class="pad" onclick="dj.hit(60)">üé∏</div><div class="pad" onclick="dj.hit(110)">üéª</div><div class="pad" onclick="dj.hit(1000)">üî´</div>
        </div></div>
    </div>

    <div id="view-art" class="full-screen hidden">
        <div class="app-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div>ART</div><button onclick="app.artClear()" style="background:none; border:none; color:red">X</button></div>
        <canvas id="art-canvas" style="background:#fff; flex:1; width:100%; touch-action:none;"></canvas>
        <button class="btn" style="position:fixed; bottom:10px; right:10px" onclick="app.artSave()">POSTEN</button>
    </div>

    <div id="view-tod" class="full-screen hidden">
        <div class="app-header"><button class="back-btn" onclick="app.nav('dash')">‚¨ÖÔ∏è</button><div>PARTY</div><div style="width:30px"></div></div>
        <div class="room-content"><h3 id="tod-q" style="text-align:center; margin-bottom:20px;">Bereit?</h3><button class="btn" onclick="app.tod('w')">Wahrheit</button><button class="btn" onclick="app.tod('p')">Pflicht</button></div>
    </div>

    <script>
        const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
        const db = gun.get('rene-party-final-v10');
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let aCtx;

        const intro = {
            vids: ['glitch1.mp4', 'glitch2.mp4', 'glitch3.mp4'],
            start: () => {
                document.getElementById('start-btn').style.display = 'none';
                aCtx = new AudioContext();
                const aud = document.getElementById('intro-music'); aud.play();
                const vid = document.getElementById('intro-vid-bg'); let i=0;
                const pV = () => { vid.src = intro.vids[i]; vid.play(); i=(i+1)%intro.vids.length; };
                vid.onended = pV; pV(); intro.seq();
            },
            seq: async () => {
                const log = (t) => { const c = document.getElementById('terminal-console'); const d = document.createElement('div'); d.className='log-line'; d.innerText='> '+t; c.appendChild(d); c.scrollTop=c.scrollHeight; };
                const big = (t) => { const o = document.getElementById('big-overlay'); o.innerText=t; o.style.opacity=1; setTimeout(()=>o.style.opacity=0, 1500); };
                const sleep = ms => new Promise(r => setTimeout(r, ms));
                log("BOOTING SYSTEM..."); await sleep(1000); log("KERNEL LOADED."); await sleep(800); big("HACKING..."); await sleep(2000);
                log("ACCESS GRANTED."); await sleep(1000); big("HAPPY BIRTHDAY REN√â!"); await sleep(3000);
                document.getElementById('view-intro').classList.add('hidden');
                document.getElementById('view-login').classList.remove('hidden');
            }
        };

        const app = {
            user: '',
            login: () => {
                const n = document.getElementById('username').value; if(!n) return;
                app.user = n; document.getElementById('display-name').innerText = n;
                app.nav('dash'); app.chatListen();
            },
            nav: (v) => { document.querySelectorAll('.full-screen').forEach(e=>e.classList.add('hidden')); document.getElementById('view-'+v).classList.remove('hidden'); if(v==='art') app.artInit(); },
            chatSend: () => { const i = document.getElementById('chat-in'); db.get('chat').set({u:app.user, t:i.value}); i.value=''; },
            chatListen: () => { db.get('chat').map().once(data => { if(!data.t) return; const d = document.createElement('div'); d.className='msg '+(data.u===app.user?'mine':'others'); d.innerText=data.u+": "+data.t; document.getElementById('chat-list').appendChild(d); }); },
            tod: (type) => { const qs = type==='w'?["Peinlichster Moment?","Erster Kuss?","Gr√∂√üte Angst?"]:["Tanz 1 Min!","Sing ein Lied!","Mach 5 Liegest√ºtze!"]; document.getElementById('tod-q').innerText = qs[Math.floor(Math.random()*qs.length)]; },
            artInit: () => {
                const c = document.getElementById('art-canvas'); const ctx = c.getContext('2d'); c.width=window.innerWidth; c.height=window.innerHeight-100;
                let draw = false; const getP = (e) => { const t = e.touches?e.touches[0]:e; return {x:t.clientX, y:t.clientY-60}; };
                c.onmousedown = c.ontouchstart = (e) => { draw=true; const p=getP(e); ctx.beginPath(); ctx.moveTo(p.x, p.y); };
                c.onmousemove = c.ontouchmove = (e) => { if(!draw) return; const p=getP(e); ctx.lineTo(p.x, p.y); ctx.stroke(); };
                c.onmouseup = c.ontouchend = () => draw=false;
            },
            artClear: () => { const c=document.getElementById('art-canvas'); c.getContext('2d').clearRect(0,0,c.width,c.height); },
            artSave: () => { alert("Bild wurde an Ren√© gesendet! (Cloud-Sync)"); app.artClear(); }
        };

        const dj = { hit: (f) => { if(!aCtx) return; const o=aCtx.createOscillator(), g=aCtx.createGain(); o.connect(g); g.connect(aCtx.destination); o.frequency.value=f; o.start(); o.stop(aCtx.currentTime+0.2); } };

        const snake = {
            ctx: null, loop: null, s: [], f: {}, d: 'r',
            start: () => {
                const c = document.getElementById('snake-canvas'); snake.ctx = c.getContext('2d');
                snake.s = [{x:10,y:10}]; snake.d='r'; snake.f={x:5,y:5};
                if(snake.loop) clearInterval(snake.loop);
                snake.loop = setInterval(snake.tick, 150);
            },
            stop: () => clearInterval(snake.loop),
            tick: () => {
                let h = {...snake.s[0]}; if(snake.d==='r') h.x++; else if(snake.d==='l') h.x--; else if(snake.d==='u') h.y--; else if(snake.d==='d') h.y++;
                snake.s.unshift(h); if(h.x===snake.f.x && h.y===snake.f.y) snake.f={x:Math.floor(Math.random()*20),y:Math.floor(Math.random()*20)}; else snake.s.pop();
                if(h.x<0||h.x>20||h.y<0||h.y>20) snake.stop();
                const c=snake.ctx; c.clearRect(0,0,280,280); c.fillStyle=window.getComputedStyle(document.documentElement).getPropertyValue('--cyan');
                snake.s.forEach(p=>c.fillRect(p.x*14, p.y*14, 12, 12)); c.fillStyle='red'; c.fillRect(snake.f.x*14, snake.f.y*14, 12, 12);
            }
        };
        window.addEventListener('keydown', (e) => { if(e.key==='ArrowUp')snake.d='u';if(e.key==='ArrowDown')snake.d='d';if(e.key==='ArrowLeft')snake.d='l';if(e.key==='ArrowRight')snake.d='r'; });
    </script>
</body>
</html>
